# 数据填充
数据填充用于新增或修改时进行表中数据自动填充，如：新增时添加uuid与租户ID、修改时添加修改人等业务场景，从以下几点区别于数据审计：
- 数据审计默认提供了审计字段定义与值的填充
- 数据填充不支持逻辑删除时填充（可以实现，目前未收到必要需求）
- 数据填充适应于，如：默认添加租户ID等需求

## 如何使用
1. 配置需要或不需要数据填充的表名

```yml
yue: 
  jdbc: 
    data-fill-table-name-match-enum: exclude                # 数据填充表名匹配方式
    data-fill-table-names:                                  # 数据填充表名
      - data_fill
      - data_fill2
```

2. 提供数据自动填充信息，实现`FillDataProvider`抽象类并配置为Bean

```java
	@Bean
	public FillDataProvider fillDataProvider() {
		return new FillDataProvider() {
            @Override
            public List<DataFillDTO> getInsertFillDTO(JdbcProperties jdbcProperties) {
                // 保留默认填充值：uuid、sort_idx
                return super.getInsertFillDTO(jdbcProperties);
            }

            @Override
            public List<DataFillDTO> getUpdateFillDTO(JdbcProperties jdbcProperties) {
                List<DataFillDTO> updateFillDTOList = super.getUpdateFillDTO(jdbcProperties);
                updateFillDTOList.add(new DataFillDTO(jdbcProperties.getDataAuditProperties().getFieldNameUpdateUser(), "ylyue"));
                return updateFillDTOList;
            }
		};
	}
```

3. 测试
- 调用`db.insertXXX()`方法，测试数据创建填充
- 调用`db.updateXXX()`方法，测试数据更新填充

## FillDataProvider（填充数据提供者）
填充数据提供者 `FillDataProvider` 抽象类，默认提供如下实现：
- 【插入填充】为`JdbcProperties.getFieldDefinitionUuid()`中定义的`uuid`字段填充一个长度为32无符号位的UUID5
- 【插入填充】为`JdbcProperties.getFieldDefinitionSortIdx()`中定义的`sort_idx`字段填充一个默认值：`0`
- 【更新填充】无

你可以保留默认填充值，也可以覆盖后自行定义，但若想开启数据填充特性，就必须提供一个实现`FillDataProvider`的Bean。
插入填充与更新填充jdbc每次都会动态获取，下面是`FillDataProvider`抽象类中插入与更新填充的默认实现代码：

```java
public abstract class FillDataProvider {

    /**
     * 插入填充（每次动态获取）
     */
    public List<DataFillDTO> getInsertFillDTO() {
        List<DataFillDTO> insertFillDTOList = new ArrayList<>();
        insertFillDTOList.add(new DataFillDTO(jdbcProperties.getFieldDefinitionUuid(), IdUtils.getSimpleUUID()));
        insertFillDTOList.add(new DataFillDTO(jdbcProperties.getFieldDefinitionSortIdx(), 0));
        return insertFillDTOList;
    }

    /**
     * 更新填充（每次动态获取）
     */
    public List<DataFillDTO> getUpdateFillDTO() {
        List<DataFillDTO> updateFillDTOList = new ArrayList<>();
        return updateFillDTOList;
    }

}
```
